---
title: 我理解的Euler，Trapezoid和Midpoint方法
date: 2015-06-01 0:36:07
categories: 技术
tags:
---
最近写了个游戏设计课关于物理计算的作业，需要用`Euler`，`Trapezoid`和`Midpoint`三种方法模拟一下炮弹的飞行。
上课没有听，后来看了下维基，开始以为很高大上，后来发现其实很容易理解。
<!--more-->
所谓`Euler`方法，其实我很早以前很多关于物理计算的代码中就是这么实现的。
在一个连续的计算中，我们通常需要用到微积分的知识，但是计算机只能进行离散的模拟，因此将一段连续的过程分割成一个一个的step进行计算。
举一个很简单的例子，就比如平抛一个物体，速度随着时间是一直变化的。一个直观的想法就是在一定的时间认为速度不变化，用该速度当做整个间隔的速度计算。

## Euler方法
假设计算的一个间隔的时间是`dt`，从状态`t1`到`t2`，取在`t1`时刻的速度`v1`，位移`v1*dt`就是所谓的`Euler`方法。

## Trapezoid方法
`Trapezoid`方法有些许不同，计算从状态`t1`到`t2`，其中`t1`到`t2`的位移和`Euler`方法一样，然后再算一次`t2`到`t3`的位移，使用的状态是`t2`时刻的`v2`，得到一个新的位移，将两次位移去个平均就是这个方法。
因此`Trapezoid`的从`t1`到`t2`的位移是`(v1+v2)*dt/2`。

## Midpoint方法
`Midpoint`方法是先计算`1/2*dt`的`Euler`方法，得到`t1`到`t2`的中间状态的速度`v1.5`，再使用`v1.5`作为整个状态的速度。
`Midpoint`方法从`t1`到`t2`的位移是`(v1.5)*dt`。

## 发现
值得一提的是，在我作业的实验中，由于速度的变化只和时间有关，和坐标无关，因此`Trapezoid`和`Midpoint`方法的结果是一样的，通俗的可以认为他们的离散计算的gap是1/2个step，而`Euler`方法是1个step，所以1/2个step的离散模拟的方法和使用微积分的知识精确求解的方法的误差更小。
